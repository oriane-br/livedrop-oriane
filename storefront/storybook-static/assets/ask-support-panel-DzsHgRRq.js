import{_ as P}from"./iframe-Dzl_Srex.js";import{j as e}from"./jsx-runtime-CDt2p4po.js";import{r}from"./index-GiUgBvb1.js";import{B as q}from"./button-DmPhT7vC.js";import{B as E}from"./badge-_4BIBrpX.js";const A=({isOpen:i,onClose:c})=>{var w;const[o,x]=r.useState(""),[l,f]=r.useState(!1),[u,m]=r.useState(null),[d,S]=r.useState([]),[p,h]=r.useState(null),[y,g]=r.useState(null),b=r.useRef(null),j=r.useRef(null);r.useEffect(()=>{i&&setTimeout(()=>{var t;(t=b.current)==null||t.focus()},100)},[i]),r.useEffect(()=>{if(!i)return;const t=s=>{var n;if(s.key==="Escape"){c();return}if(s.key==="Tab"){const a=(n=j.current)==null?void 0:n.querySelectorAll('button, textarea, [tabindex]:not([tabindex="-1"])');if(!a)return;const N=a[0],k=a[a.length-1];s.shiftKey?document.activeElement===N&&(s.preventDefault(),k.focus()):document.activeElement===k&&(s.preventDefault(),N.focus())}};return document.addEventListener("keydown",t),()=>document.removeEventListener("keydown",t)},[i,c]);const v=async()=>{if(o.trim()){f(!0),m(null),h(null),g(null);try{const{supportEngine:t}=await P(async()=>{const{supportEngine:n}=await import("./engine-BhRm_R69.js");return{supportEngine:n}},[],import.meta.url),s=await t(o.trim());if(s&&s.answer){const n={id:Date.now().toString(),question:o.trim(),answer:s.answer,citation:s.citation,timestamp:new Date};S(a=>[n,...a]),h(s.answer),g(s.citation||null),x("")}else m("Sorry, I couldn't find an answer to your question. Please try rephrasing or contact support directly.")}catch(t){m("Something went wrong. Please try again or contact support directly."),console.error("Support engine error:",t)}finally{f(!1)}}},C=t=>{t.key==="Enter"&&(t.ctrlKey||t.metaKey)&&(t.preventDefault(),v())},L=t=>{t.target===t.currentTarget&&c()};return i?e.jsxs("div",{className:"fixed inset-0 z-50 overflow-hidden",onClick:L,children:[e.jsx("div",{className:"absolute inset-0 bg-black bg-opacity-50 transition-opacity"}),e.jsxs("div",{ref:j,className:"absolute right-0 top-0 h-full w-full max-w-md bg-white shadow-xl transform transition-transform duration-300 ease-in-out translate-x-0",role:"dialog","aria-modal":"true","aria-labelledby":"support-panel-title",children:[e.jsxs("div",{className:"flex items-center justify-between p-4 border-b border-gray-200",children:[e.jsx("h2",{id:"support-panel-title",className:"text-lg font-semibold text-gray-900",children:"Ask Support"}),e.jsx("button",{onClick:c,className:"p-2 text-gray-400 hover:text-gray-600 transition-colors","aria-label":"Close support panel",children:e.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]}),e.jsxs("div",{className:"flex flex-col h-full",children:[e.jsx("div",{className:"p-4 border-b border-gray-200",children:e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{children:[e.jsx("label",{htmlFor:"support-question",className:"block text-sm font-medium text-gray-700 mb-1",children:"Your Question"}),e.jsx("textarea",{ref:b,id:"support-question",value:o,onChange:t=>x(t.target.value),onKeyDown:C,placeholder:"Ask a question about orders, returns, payments...",className:"w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500 resize-none",rows:3,disabled:l}),e.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"I can help with policy questions and order status. Press Ctrl+Enter to submit."})]}),e.jsx(q,{onClick:v,disabled:!o.trim()||l,className:"w-full",children:l?"Processing...":"Ask Question"})]})}),e.jsxs("div",{className:"flex-1 overflow-y-auto p-4 space-y-4",children:[p&&e.jsxs("div",{className:"bg-gray-50 rounded-lg p-4 space-y-3",children:[e.jsx("div",{className:"font-semibold text-gray-900",children:(w=d[0])==null?void 0:w.question}),e.jsx("div",{className:"text-gray-700 whitespace-pre-wrap",children:p}),y&&e.jsx("div",{className:"flex justify-end",children:e.jsx(E,{variant:"info",size:"sm",children:y})})]}),u&&e.jsx("div",{className:"bg-red-50 border border-red-200 rounded-lg p-4",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx("svg",{className:"w-5 h-5 text-red-400 mr-2",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 8v4m0 4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})}),e.jsx("span",{className:"text-red-800 text-sm",children:u})]})}),l&&e.jsx("div",{className:"bg-blue-50 border border-blue-200 rounded-lg p-4",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-blue-600 mr-2"}),e.jsx("span",{className:"text-blue-800 text-sm",children:"Processing your question..."})]})}),d.length>0&&e.jsxs("div",{className:"space-y-3",children:[e.jsx("h3",{className:"text-sm font-medium text-gray-700",children:"Previous Questions"}),d.slice(1).map(t=>e.jsxs("div",{className:"bg-white border border-gray-200 rounded-lg p-3 space-y-2",children:[e.jsx("div",{className:"font-medium text-sm text-gray-900",children:t.question}),e.jsx("div",{className:"text-sm text-gray-600 whitespace-pre-wrap",children:t.answer}),t.citation&&e.jsx("div",{className:"flex justify-end",children:e.jsx(E,{variant:"info",size:"sm",children:t.citation})})]},t.id))]}),d.length===0&&!l&&!u&&!p&&e.jsxs("div",{className:"flex flex-col items-center justify-center py-12 text-center",children:[e.jsx("svg",{className:"w-12 h-12 text-gray-300 mb-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M8.228 9c.549-1.165 2.03-2 3.772-2 2.21 0 4 1.343 4 3 0 1.4-1.278 2.575-3.006 2.907-.542.104-.994.54-.994 1.093m0 3h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})}),e.jsx("p",{className:"text-gray-500 text-sm",children:"Ask me anything about orders, returns, or policies!"})]})]})]})]})]}):null};A.__docgenInfo={description:"",methods:[],displayName:"AskSupportPanel",props:{isOpen:{required:!0,tsType:{name:"boolean"},description:""},onClose:{required:!0,tsType:{name:"signature",type:"function",raw:"() => void",signature:{arguments:[],return:{name:"void"}}},description:""}}};export{A};
